# Take ground truth labels for the colleted audio data from user
import csv
import sys
import time
from path import *
import os
import pandas as pd
import math
from scipy import *
# Variables
label = []
stime_str = []
etime_str = []

# Input arguments
day = sys.argv[1]
filename = GROUNDTRUTH_PATH + 'ground_truth_' + day + '.csv'


# Train Data for Hostel
# 10-17Feb

# 10/02/2014 - 11/02/2014
# time_str = ['10/2/2014-21.24.59','10/2/2014-22.11.33',
#             '10/2/2014-21.08.06', '10/2/2014-21.10.35', '10/2/2014-22.12.15', 
#             '10/2/2014-22.58.10', '10/2/2014-22.17.25']

# event = ['TL','TL','TL','TL','TL','TL','TL']
# room = ['1','1', '2', '2', '2', '2', '6']


# Room 1 
# time_str = ['10/2/2014-21.24.59','10/2/2014-22.11.33']
# event = ['TL','TL']

# Room 2
# time_str = ['10/2/2014-21.08.06', '10/2/2014-21.10.35', '10/2/2014-22.12.15','10/2/2014-22.58.10']
# event = ['TL','TL','TL','TL']

# Room 6
# time_str = ['10/2/2014-22.17.25']
# event = ['TL']

# 11/02/2014 - 12/02/2014

# time_str = ['11/2/2014-02.50.44', '11/2/2014-12.30.09', '11/2/2014-12.35.02', 
#             '11/2/2014-12.51.47', '11/2/2014-13.10.57', '11/2/2014-01.01.58',
#              '11/2/2014-03.20.33','11/2/2014-09.33.58', '11/2/2014-09.59.11',
#             '11/2/2014-13.31.40','11/2/2014-13.53.36', '11/2/2014-17.47.05',
#              '11/2/2014-17.58.26','11/2/2014-18.43.05', '11/2/2014-20.34.46',
#             '11/2/2014-21.12.16','11/2/2014-22.54.02', '11/2/2014-23.42.37',
#              '11/2/2014-00.04.06','11/2/2014-00.21.36', '11/2/2014-09.28.16',
#             '11/2/2014-09.48.08','11/2/2014-10.02.23', '11/2/2014-11.25.01',
#             '11/2/2014-20.02.56','11/2/2014-20.41.30', '11/2/2014-20.53.48', 
#             '11/2/2014-00.33.40','11/2/2014-01.08.36', '11/2/2014-03.03.51',
#             '11/2/2014-09.55.25','11/2/2014-20.07.09', '11/2/2014-22.22.14',
#             '11/2/2014-01.28.25','11/2/2014-07.58.25', '11/2/2014-08.03.42',
#             '11/2/2014-08.38.05','11/2/2014-08.46.01', '11/2/2014-08.59.46',
#             '11/2/2014-09.55.08', '11/2/2014-09.58.10',
#             '11/2/2014-09.59.38','11/2/2014-10.05.56', '11/2/2014-14.16.32',
#             '11/2/2014-20.34.57', '11/2/2014-21.05.39', '11/2/2014-00.01.33',
#             '11/2/2014-00.36.37', '11/2/2014-00.37.17', '11/2/2014-00.59.41',
#             '11/2/2014-14.33.14', '11/2/2014-21.17.02','11/2/2014-00.21.19',
#             '11/2/2014-00.33.40','11/2/2014-00.37.17','11/2/2014-01.01.57',
#             '11/2/2014-09.24.56','11/2/2014-09.52.53','11/2/2014-09.55.08',
#             '11/2/2014-10.00.06','11/2/2014-10.05.56','11/2/2014-10.23.41',
#             '11/2/2014-10.33.37','11/2/2014-10.34.40','11/2/2014-22.10.33',
#             '11/2/2014-22.07.40', '11/2/2014-14.33.14','11/2/2014-17.57.25']

# event = ['TL','TL','TL',
#         'TL','TL','TL',
#         'TL','TL','TL',
#         'TL','TL','TL',
#         'TL','TL','TL',
#         'TL','TL','TL',
#         'TL','TL','TL',
#         'TL','TL','TL',
#         'TL','TL','TL',
#         'TL','TL','TL',
#         'TL','TL','TL',
#         'TL','TL','TL',
#         'TL','TL','TL',
#         'TL','TL','TL',
#         'TL','TL','TL', 'TL','TL',
#         'LP', 'LP', 'LP', 'LP', 'LP', 'LP','TL','TL','RP','LP',
#         'LP','TL','RP','TL','LP','TL','TL','LP','RP','RP','RP']

# room = ['1','1','1',
#         '1','1','2',
#         '2','2','2',
#         '2','2','2',
#         '2','2','2',
#         '2','2','2',
#         '4','4','3',
#         '4','3','3',
#         '3','3','4',
#         '5','5','5',
#         '5','5','5',
#         '6','6','6',
#         '6','6','6',
#         '6','5',
#         '5','5','6',
#         '6','6','5',
#         '5','5','5',
#         '5','5','5',
#         '6','6','3',
#         '3','4','5',
#         '5','5','4',
#         '4','3','4',
#         '6','6','6',
        
#         ]

# # Room 1
# time_str = [ '11/2/2014-02.50.44', '11/2/2014-12.30.09', '11/2/2014-12.35.02', 
#              '11/2/2014-12.51.47', '11/2/2014-13.10.57']

# event = ['TL','TL','TL','TL','TL']

# # Room 2
# time_str = [ '11/2/2014-01.01.58', '11/2/2014-03.20.33', '11/2/2014-09.33.58',
#              '11/2/2014-09.59.11', '11/2/2014-13.31.40', '11/2/2014-13.53.36',
#              '11/2/2014-17.47.05', '11/2/2014-17.58.26', '11/2/2014-18.43.05',
#              '11/2/2014-20.34.46', '11/2/2014-21.12.16', '11/2/2014-22.54.02', 
#              '11/2/2014-23.42.37']

# event = ['TL','TL','TL','TL','TL','TL','TL','TL','TL','TL','TL',
#          'TL','TL']

# # Room 3
# time_str = [ '11/2/2014-09.28.16','11/2/2014-10.02.23', '11/2/2014-11.25.01',
#              '11/2/2014-20.02.56', '11/2/2014-20.41.30','11/2/2014-01.01.57',
#              '11/2/2014-09.24.56','11/2/2014-09.55.08','11/2/2014-10.33.37',
#              ]

# event = ['TL','TL','TL','TL','TL','LP','LP','RP','LP']

# # Room 4
# time_str = [ '11/2/2014-00.04.06','11/2/2014-00.21.36','11/2/2014-09.48.08',
#              '11/2/2014-20.53.48','11/2/2014-09.52.53','11/2/2014-10.34.40',
#              '11/2/2014-22.10.33']

# event = ['TL','TL','TL','TL','RP','LP','TL']

# # Room 5
# time_str = [ '11/2/2014-00.33.40', '11/2/2014-01.08.36', '11/2/2014-03.03.51', 
#              '11/2/2014-09.55.25', '11/2/2014-20.07.09', '11/2/2014-22.22.14',
#              '11/2/2014-09.55.25', '11/2/2014-09.58.10', '11/2/2014-09.59.38',
#              '11/2/2014-10.05.56', '11/2/2014-00.01.33', '11/2/2014-00.36.37',
#              '11/2/2014-00.37.17', '11/2/2014-00.59.41', '11/2/2014-14.33.14',
#              '11/2/2014-21.17.02', '11/2/2014-00.21.19','11/2/2014-10.00.06',
#              '11/2/2014-10.05.56','11/2/2014-10.23.41']

# event = ['TL','TL','TL','TL','TL','TL','TL','TL','TL','TL','LP', 'LP', 'LP',
#          'LP', 'LP', 'LP','TL','TL','RP','TL']

# # Room 6
# time_str = [ '11/2/2014-01.28.25','11/2/2014-07.58.25', '11/2/2014-08.03.42',
#              '11/2/2014-08.38.05','11/2/2014-08.46.01', '11/2/2014-08.59.46',
#              '11/2/2014-09.55.08','11/2/2014-14.16.32','11/2/2014-20.34.57',
#              '11/2/2014-21.05.39','11/2/2014-00.33.40', '11/2/2014-00.37.17']

# event = ['TL','TL','TL','TL','TL','TL','TL','TL','TL','TL','TL','RP']

# 12/02/2014 - 13/02/2014

# time_str = ['12/2/2014-11.00.44','12/2/2014-13.35.19','12/2/2014-16.16.49',
#             '12/2/2014-17.23.27','12/2/2014-18.36.44','12/2/2014-18.41.06',
#             '12/2/2014-19.04.09','12/2/2014-21.02.25','12/2/2014-22.01.44',
#             '12/2/2014-00.08.48','12/2/2014-00.20.27','12/2/2014-00.46.11',
#             '12/2/2014-09.28.40','12/2/2014-09.29.26','12/2/2014-10.39.18',
#             '12/2/2014-11.53.12','12/2/2014-12.39.10','12/2/2014-12.49.10',
#             '12/2/2014-12.59.59','12/2/2014-13.07.55','12/2/2014-17.05.43',
#             '12/2/2014-17.06.12','12/2/2014-19.43.32','12/2/2014-23.57.35',
#             '12/2/2014-01.37.52','12/2/2014-08.29.30','12/2/2014-08.33.03',
#             '12/2/2014-09.02.35','12/2/2014-09.11.57','12/2/2014-09.25.56',
#             '12/2/2014-09.26.25','12/2/2014-09.30.34','12/2/2014-09.32.17',
#             '12/2/2014-12.59.59','12/2/2014-13.05.48','12/2/2014-14.35.42',
#             '12/2/2014-14.45.38','12/2/2014-16.59.08','12/2/2014-17.03.14',
#             '12/2/2014-19.38.38',
#             '12/2/2014-20.53.35','12/2/2014-21.23.19','12/2/2014-23.35.32',
#             '12/2/2014-23.41.54',
#             '12/2/2014-09.43.16','12/2/2014-12.40.50','12/2/2014-06.57.16',
#             '12/2/2014-20.43.57',
#             '12/2/2014-13.04.52','12/2/2014-10.37.29','12/2/2014-08.08.25',
#             '12/2/2014-10.30.34']

# event = ['TL','TL','TL','TL','TL','TL','TL','TL','TL','TL','TL','TL','TL','TL'
#         ,'TL','TL','TL','TL','TL','TL','TL','TL','TL','TL','TL','TL','TL','TL',
#         'TL','TL','TL','TL','TL','TL','TL','TL','TL','TL','TL','TL',
#         'TL','TL','TL','TL','RP','RP',
#         'LP','LP','RP','LP','TL','TL']
# room = ['1','1','1','1','1','1','1','1','1','2',
#         '4','5','5','5','5','5','5','5','5','5',
#         '6','6','5','5','6','6','6','6','6','6',
#         '6','6','6','6','6','6','6','6','6','6','6','6','6','6','6',
#         '6','4','4','3','3','2','2']

# 13/02/2014 - 14/02/2014

time_str = ['13/2/2014-1.28.45','13/2/2014-8.4.27','13/2/2014-08.34.09',
            '13/2/2014-11.07.38','13/2/2014-11.09.09','13/2/2014-11.23.19',
            '13/2/2014-12.22.16','13/2/2014-13.05.06','13/2/2014-13.09.20',
            '13/2/2014-17.53.54','13/2/2014-20.47.31','13/2/2014-22.15.46',
            '13/2/2014-20.06.08','13/2/2014-20.32.44','13/2/2014-08.19.37',
            '13/2/2014-08.19.37','13/2/2014-10.05.33','13/2/2014-10.05.33',
            '13/2/2014-22.28.18','13/2/2014-22.28.18','13/2/2014-01.23.49',
            '13/2/2014-1.25.31','13/2/2014-01.34.25','13/2/2014-07.25.07',
            '13/2/2014-07.25.07','13/2/2014-08.54.44','13/2/2014-08.54.44',
            '13/2/2014-09.10.23','13/2/2014-09.10.23','13/2/2014-09.22.10',
            '13/2/2014-09.22.10','13/2/2014-11.24.32','13/2/2014-11.26.47',
            '13/2/2014-11.30.04','13/2/2014-11.31.27','13/2/2014-11.36.47',
            '13/2/2014-13.46.33','13/2/2014-17.42.46','13/2/2014-17.47.29',
            '13/2/2014-17.48.59','13/2/2014-17.50.23','13/2/2014-17.50.35',
            '13/2/2014-18.01.53','13/2/2014-22.10.21','13/2/2014-22.10.21',
            '13/2/2014-22.11.35','13/2/2014-22.11.35','13/2/2014-22.17.15',
            '13/2/2014-22.28.49','13/2/2014-23.51.59','13/2/2014-23.53.22',
            '13/2/2014-18.01.30','13/2/2014-21.16.52','13/2/2014-22.18.23',
            '13/2/2014-22.26.33','13/2/2014-23.25.10','13/2/2014-23.16.23',
            '13/2/2014-23.18.08','13/2/2014-23.24.28','13/2/2014-22.28.20',
            '13/2/2014-16.15.55']
room = ['1','1','1',
        '1','1','1',
        '1','1','1',
        '1','1','1',
        '3','3','4',
        '3','4','3',
        '4','3','5',
        '5','6','5',
        '6','5','6',
        '5','6','5',
        '6','5','5',
        '5','5','6',
        '6','5','5',
        '5','6','6',
        '6','5','6',
        '5','6','5',
        '5','6','6',
        '5','5','6',
        '6','5','5',
        '5','5','6',
        '3'
        ]
event = ['TL','TL','TL',
        'TL','TL','TL',
        'TL','TL','TL',
        'TL','TL','TL',
        'TL','TL','RP',
        'RP','LP','LP',
        'LP','LP','TL',
        'TL','TL','TL',
        'TL','TL','TL',
        'TL','TL','TL',
        'TL','TL','TL',
        'TL','TL','TL',
        'TL','TL','TL',
        'TL','TL','TL',
        'TL','TL','TL',
        'TL','TL','TL',
        'TL','TL','TL',
        'RP','RP','RP',
        'RP','TL','TL',
        'TL','TL','TL',
        'TL']




# ## Test Label

# for row in zip(time_str, event, room):
   
#     print "[", row[0], " - ", row[1], " - ", row[2], "]"

# # Output file
# print "Writing to file - ", filename
# writer = csv.writer(open(filename, "w"))

# # For test dataset

# writer.writerow(['Event Time', 'Event', 'Room'])
# no_loop = len(time_str)

# # Convert to timestamp and store in a CSV
# for x in range(no_loop):
#     tstamp = long(
#         time.mktime(time.strptime(time_str[x], "%d/%m/%Y-%H.%M.%S")) * 1000)
    
# # For test dataset
    
#     print tstamp, event[x], room[x]
#     writer.writerow([tstamp, event[x], room[x]])

# ## Room wise ground truth for each day

df = pd.read_csv(filename)

rooms = df.Room.unique()
gt_path_room = GROUNDTRUTH_PATH + day

if not os.path.isdir(gt_path_room):
        os.makedirs(gt_path_room)

for room in rooms:

        df_room = df.ix[df.Room == room]
        df_room.index = arange(0, len(df_room))
        df_room = df_room.sort_index(by = 'Event Time')
        df_room.to_csv(gt_path_room + '/' + 'C00' + str(room) + '.csv', cols = df_room.columns.values, index = False)
"""
    # For training dataset
    if sensor == "sound":
        print s_tstamp, e_tstamp, slabel[x]
        writer.writerow([s_tstamp, e_tstamp, slabel[x], phase[x]])
    elif sensor == "wifi":
        print s_tstamp, e_tstamp, wlabel[x]
        writer.writerow([s_tstamp, e_tstamp, wlabel[x], phase[x]])
"""
    
